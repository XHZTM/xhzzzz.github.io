import{p as W,B as T,H as he,m as v,s as y,x as U,a2 as pe,Z as X,J as ge,P as $,K as Y,Q as L,a9 as be,aa as ee,V as ke,M as ye,F as xe}from"./main-f7c1aeb0.js";import{c as I,d as Te,f as O,g as J,n as j,m as N,h as V,j as _e,k as se,o as ie,p as ue,q as re,H as te,r as z,t as Oe,s as Ce,v as we,w as Pe,x as q,L as Ee,y as ne,B as Se,z as He,P as Me}from"./index-9540d5e7.js";const[Be,k,oe]=I("picker"),de=e=>e.find(o=>!o.disabled)||e[0];function De(e,o){const n=e[0];if(n){if(Array.isArray(n))return"multiple";if(o.children in n)return"cascade"}return"default"}function Q(e,o){o=J(o,0,e.length);for(let n=o;n<e.length;n++)if(!e[n].disabled)return n;for(let n=o-1;n>=0;n--)if(!e[n].disabled)return n;return 0}const le=(e,o,n)=>o!==void 0&&!!e.find(c=>c[n.value]===o);function Z(e,o,n){const c=e.findIndex(f=>f[n.value]===o),a=Q(e,c);return e[a]}function Ne(e,o,n){const c=[];let a={[o.children]:e},f=0;for(;a&&a[o.children];){const u=a[o.children],r=n.value[f];if(a=Te(r)?Z(u,r,o):void 0,!a&&u.length){const d=de(u)[o.value];a=Z(u,d,o)}f++,c.push(u)}return c}function Ve(e){const{transform:o}=window.getComputedStyle(e),n=o.slice(7,o.length-1).split(", ")[5];return Number(n)}function Ie(e){return O({text:"text",value:"value",children:"children"},e)}const ae=200,ce=300,Re=15,[me,G]=I("picker-column"),ve=Symbol(me);var Ae=W({name:me,props:{value:j,fields:N(Object),options:V(),readonly:Boolean,allowHtml:Boolean,optionHeight:N(Number),swipeDuration:N(j),visibleOptionNum:N(j)},emits:["change","clickOption"],setup(e,{emit:o,slots:n}){let c,a,f,u,r;const d=T(),g=T(),h=T(0),p=T(0),_=_e(),C=()=>e.options.length,P=()=>e.optionHeight*(+e.visibleOptionNum-1)/2,x=s=>{const m=Q(e.options,s),t=-m*e.optionHeight,l=()=>{const i=e.options[m][e.fields.value];i!==e.value&&o("change",i)};c&&t!==h.value?r=l:l(),h.value=t},b=()=>e.readonly||!e.options.length,A=s=>{c||b()||(r=null,p.value=ae,x(s),o("clickOption",e.options[s]))},E=s=>J(Math.round(-s/e.optionHeight),0,C()-1),S=(s,m)=>{const t=Math.abs(s/m);s=h.value+t/.003*(s<0?-1:1);const l=E(s);p.value=+e.swipeDuration,x(l)},H=()=>{c=!1,p.value=0,r&&(r(),r=null)},F=s=>{if(!b()){if(_.start(s),c){const m=Ve(g.value);h.value=Math.min(0,m-P())}p.value=0,a=h.value,f=Date.now(),u=a,r=null}},K=s=>{if(b())return;_.move(s),_.isVertical()&&(c=!0,re(s,!0)),h.value=J(a+_.deltaY.value,-(C()*e.optionHeight),e.optionHeight);const m=Date.now();m-f>ce&&(f=m,u=h.value)},M=()=>{if(b())return;const s=h.value-u,m=Date.now()-f;if(m<ce&&Math.abs(s)>Re){S(s,m);return}const l=E(h.value);p.value=ae,x(l),setTimeout(()=>{c=!1},0)},B=()=>{const s={height:`${e.optionHeight}px`};return e.options.map((m,t)=>{const l=m[e.fields.text],{disabled:i}=m,D=m[e.fields.value],w={role:"button",style:s,tabindex:i?-1:0,class:[G("item",{disabled:i,selected:D===e.value}),m.className],onClick:()=>A(t)},fe={class:"van-ellipsis",[e.allowHtml?"innerHTML":"textContent"]:l};return v("li",w,[n.option?n.option(m,t):v("div",fe,null)])})};return se(ve),ie({stopMomentum:H}),he(()=>{const s=e.options.findIndex(l=>l[e.fields.value]===e.value),t=-Q(e.options,s)*e.optionHeight;h.value=t}),ue("touchmove",K,{target:d}),()=>v("div",{ref:d,class:G(),onTouchstartPassive:F,onTouchend:M,onTouchcancel:M},[v("ul",{ref:g,style:{transform:`translate3d(0, ${h.value+P()}px, 0)`,transitionDuration:`${p.value}ms`,transitionProperty:p.value?"all":"none"},class:G("wrapper"),onTransitionend:H},[B()])])}});const[Fe]=I("picker-toolbar"),R={title:String,cancelButtonText:String,confirmButtonText:String},Ke=["cancel","confirm","title","toolbar"],Ue=Object.keys(R);var $e=W({name:Fe,props:R,emits:["confirm","cancel"],setup(e,{emit:o,slots:n}){const c=()=>{if(n.title)return n.title();if(e.title)return v("div",{class:[k("title"),"van-ellipsis"]},[e.title])},a=()=>o("cancel"),f=()=>o("confirm"),u=()=>{const d=e.cancelButtonText||oe("cancel");return v("button",{type:"button",class:[k("cancel"),te],onClick:a},[n.cancel?n.cancel():d])},r=()=>{const d=e.confirmButtonText||oe("confirm");return v("button",{type:"button",class:[k("confirm"),te],onClick:f},[n.confirm?n.confirm():d])};return()=>v("div",{class:k("toolbar")},[n.toolbar?n.toolbar():[u(),c(),r()]])}});const[Ye,tt]=I("picker-group"),Le=Symbol(Ye);O({tabs:V(),nextStepText:String},R);const je=O({loading:Boolean,readonly:Boolean,allowHtml:Boolean,optionHeight:z(44),showToolbar:Oe,swipeDuration:z(1e3),visibleOptionNum:z(6)},R),ze=O({},je,{columns:V(),modelValue:V(),toolbarPosition:Ce("top"),columnsFieldNames:Object});var qe=W({name:Be,props:ze,emits:["confirm","cancel","change","clickOption","update:modelValue"],setup(e,{emit:o,slots:n}){const c=T(),a=T(e.modelValue.slice(0)),{parent:f}=se(Le),{children:u,linkChildren:r}=we(ve);r();const d=y(()=>Ie(e.columnsFieldNames)),g=y(()=>Pe(e.optionHeight)),h=y(()=>De(e.columns,d.value)),p=y(()=>{const{columns:t}=e;switch(h.value){case"multiple":return t;case"cascade":return Ne(t,d.value,a);default:return[t]}}),_=y(()=>p.value.some(t=>t.length)),C=y(()=>p.value.map((t,l)=>Z(t,a.value[l],d.value))),P=y(()=>p.value.map((t,l)=>t.findIndex(i=>i[d.value.value]===a.value[l]))),x=(t,l)=>{if(a.value[t]!==l){const i=a.value.slice(0);i[t]=l,a.value=i}},b=()=>({selectedValues:a.value.slice(0),selectedOptions:C.value,selectedIndexes:P.value}),A=(t,l)=>{x(l,t),h.value==="cascade"&&a.value.forEach((i,D)=>{const w=p.value[D];le(w,i,d.value)||x(D,w.length?w[0][d.value.value]:void 0)}),X(()=>{o("change",O({columnIndex:l},b()))})},E=(t,l)=>o("clickOption",O({columnIndex:l,currentOption:t},b())),S=()=>{u.forEach(l=>l.stopMomentum());const t=b();return X(()=>{o("confirm",t)}),t},H=()=>o("cancel",b()),F=()=>p.value.map((t,l)=>v(Ae,{value:a.value[l],fields:d.value,options:t,readonly:e.readonly,allowHtml:e.allowHtml,optionHeight:g.value,swipeDuration:e.swipeDuration,visibleOptionNum:e.visibleOptionNum,onChange:i=>A(i,l),onClickOption:i=>E(i,l)},{option:n.option})),K=t=>{if(_.value){const l={height:`${g.value}px`},i={backgroundSize:`100% ${(t-g.value)/2}px`};return[v("div",{class:k("mask"),style:i},null),v("div",{class:[Se,k("frame")],style:l},null)]}},M=()=>{const t=g.value*+e.visibleOptionNum,l={height:`${t}px`};return v("div",{ref:c,class:k("columns"),style:l},[F(),K(t)])},B=()=>{if(e.showToolbar&&!f)return v($e,pe(ne(e,Ue),{onConfirm:S,onCancel:H}),ne(n,Ke))};U(p,t=>{t.forEach((l,i)=>{l.length&&!le(l,a.value[i],d.value)&&x(i,de(l)[d.value.value])})},{immediate:!0});let s;return U(()=>e.modelValue,t=>{!q(t,a.value)&&!q(t,s)&&(a.value=t.slice(0),s=t.slice(0))},{deep:!0}),U(a,t=>{q(t,e.modelValue)||(s=t.slice(0),o("update:modelValue",s))},{immediate:!0}),ue("touchmove",re,{target:c}),ie({confirm:S,getSelectedOptions:()=>C.value}),()=>{var t,l;return v("div",{class:k()},[e.toolbarPosition==="top"?B():null,e.loading?v(Ee,{class:k("loading")},null):null,(t=n["columns-top"])==null?void 0:t.call(n),M(),(l=n["columns-bottom"])==null?void 0:l.call(n),e.toolbarPosition==="bottom"?B():null])}}});const Ge=He(qe);const Je={name:"MobileSelect",props:["modelValue","options","placeholder","style","disabled"],emits:["update:modelValue"],components:{"van-picker":Ge,"van-popup":Me},setup(e,{emit:o}){const n=T(!1),c=()=>{e.disabled||(n.value=!0)},a=u=>{n.value=!1;const r=u.selectedOptions[0].value;o("update:modelValue",r)},f=y(()=>{if(e.modelValue){let u="";return e.options.forEach(r=>{r.value===e.modelValue&&(u=r.text)}),u}return""});return{click:c,showPicker:n,modalText:f,onConfirm:a}}};const Qe={key:0},Ze={key:1,class:"placeholder"};function We(e,o,n,c,a,f){const u=$("my-icon"),r=$("van-picker"),d=$("van-popup");return Y(),L(xe,null,[be("div",{style:ke(n.style),class:"select-box",onClick:o[0]||(o[0]=(...g)=>c.click&&c.click(...g))},[c.modalText?(Y(),L("span",Qe,ee(c.modalText),1)):(Y(),L("span",Ze,ee(n.placeholder),1)),v(u,{type:"icon-arrow-down-bold",class:"placeholder"})],4),v(d,{show:c.showPicker,"onUpdate:show":o[2]||(o[2]=g=>c.showPicker=g),round:"",position:"bottom"},{default:ye(()=>[v(r,{columns:n.options,onCancel:o[1]||(o[1]=g=>c.showPicker=!1),onConfirm:c.onConfirm},null,8,["columns","onConfirm"])]),_:1},8,["show"])],64)}const nt=ge(Je,[["render",We],["__scopeId","data-v-92456d71"]]);export{nt as default};
